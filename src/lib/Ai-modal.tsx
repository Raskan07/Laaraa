/*
 * Install the Generative AI SDK
 *
 * $ npm install @google/generative-ai
 */

import {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} from "@google/generative-ai";

// const apiKey = process.env.GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI("AIzaSyBkN_dw2c36Pye-wVck7tnbZCN52IU_Spw");

const model = genAI.getGenerativeModel({
  model: "gemini-1.5-flash",
});

const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 64,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
  };



export const onGetData = async (promt:any) => {
    const chatSession = model.startChat({
        generationConfig,
        history: [
          {
            role: "model",
            parts: [
              {text: "```json\n{\"response\": \"{\\n  \\\"hotels\\\": [\\n    {\\n      \\\"name\\\": \\\"The Fortress Resort & Spa\\\",\\n      \\\"description\\\": \\\"A luxurious beachfront resort with stunning ocean views, offering a range of amenities, including swimming pools, restaurants, and a spa.\\\",\\n      \\\"imgUrl\\\": \\\"https://example.com/fortress-resort.jpg\\\",\\n      \\\"rating\\\": 4.5,\\n      \\\"fees\\\": {\\n        \\\"standard_room\\\": 150,\\n        \\\"suite\\\": 300\\n      },\\n      \\\"openingHours\\\": \\\"7:00 AM - 10:00 PM\\\",\\n      \\\"geoCoords\\\": {\\n        \\\"lat\\\": 6.3524,\\n        \\\"lang\\\": 80.1446\\n      },\\n      \\\"contactInformation\\\": {\\n        \\\"phone\\\": \\\"+94 11 234 5678\\\",\\n        \\\"email\\\": \\\"info@fortressresort.com\\\"\\n      },\\n      \\\"tickets\\\": null\\n    },\\n    {\\n      \\\"name\\\": \\\"The Beach House Beruwala\\\",\\n      \\\"description\\\": \\\"A charming boutique hotel located directly on the beach, known for its intimate atmosphere and personalized service.\\\",\\n      \\\"imgUrl\\\": \\\"https://example.com/beach-house.jpg\\\",\\n      \\\"rating\\\": 4.0,\\n      \\\"fees\\\": {\\n        \\\"standard_room\\\": 100,\\n        \\\"deluxe_room\\\": 150\\n      },\\n      \\\"openingHours\\\": \\\"8:00 AM - 9:00 PM\\\",\\n      \\\"geoCoords\\\": {\\n        \\\"lat\\\": 6.3492,\\n        \\\"lang\\\": 80.1451\\n      },\\n      \\\"contactInformation\\\": {\\n        \\\"phone\\\": \\\"+94 11 234 5679\\\",\\n        \\\"email\\\": \\\"info@beachhouseberuwala.com\\\"\\n      },\\n      \\\"tickets\\\": null\\n    },\\n    {\\n      \\\"name\\\": \\\"Palm Beach Hotel\\\",\\n      \\\"description\\\": \\\"A family-friendly hotel offering a wide range of facilities, including a kids' club, swimming pool, and a variety of dining options.\\\",\\n      \\\"imgUrl\\\": \\\"https://example.com/palm-beach-hotel.jpg\\\",\\n      \\\"rating\\\": 3.5,\\n      \\\"fees\\\": {\\n        \\\"standard_room\\\": 75,\\n        \\\"family_room\\\": 125\\n      },\\n      \\\"openingHours\\\": \\\"9:00 AM - 10:00 PM\\\",\\n      \\\"geoCoords\\\": {\\n        \\\"lat\\\": 6.3505,\\n        \\\"lang\\\": 80.1463\\n      },\\n      \\\"contactInformation\\\": {\\n        \\\"phone\\\": \\\"+94 11 234 5680\\\",\\n        \\\"email\\\": \\\"info@palmbeachhotel.com\\\"\\n      },\\n      \\\"tickets\\\": null\\n    }\\n  ],\\n  \\\"activities\\\": [\\n    {\\n      \\\"day\\\": \\\"Oct 11 2024\\\",\\n      \\\"activities\\\": [\\n        {\\n          \\\"placeName\\\": \\\"Galle Fort\\\",\\n          \\\"contact\\\": null,\\n          \\\"rating\\\": 4.8,\\n          \\\"geoCoords\\\": {\\n            \\\"lat\\\": 6.0413,\\n            \\\"lang\\\": 80.2301\\n          },\\n          \\\"description\\\": \\\"A UNESCO World Heritage Site, Galle Fort is a well-preserved 17th-century Dutch fort with cobblestone streets, historic buildings, and stunning views of the Indian Ocean.\\\",\\n          \\\"whatToDo\\\": \\\"Explore the historic streets, visit the lighthouse, shop for souvenirs, and enjoy the vibrant atmosphere.\\\",\\n          \\\"ticketFees\\\": null,\\n          \\\"openingHours\\\": \\\"8:00 AM - 6:00 PM\\\",\\n          \\\"imagesOfPlace\\\": [\\\"https://example.com/galle-fort-1.jpg\\\", \\\"https://example.com/galle-fort-2.jpg\\\"]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"day\\\": \\\"Oct 12 2024\\\",\\n      \\\"activities\\\": [\\n        {\\n          \\\"placeName\\\": \\\"Beruwala Beach\\\",\\n          \\\"contact\\\": null,\\n          \\\"rating\\\": 4.5,\\n          \\\"geoCoords\\\": {\\n            \\\"lat\\\": 6.3504,\\n            \\\"lang\\\": 80.1462\\n          },\\n          \\\"description\\\": \\\"A beautiful stretch of golden sand with calm waters, perfect for swimming, sunbathing, and enjoying water sports.\\\",\\n          \\\"whatToDo\\\": \\\"Relax on the beach, go for a swim, try water sports like jet skiing and windsurfing, or simply enjoy the breathtaking views.\\\",\\n          \\\"ticketFees\\\": null,\\n          \\\"openingHours\\\": \\\"24 hours\\\",\\n          \\\"imagesOfPlace\\\": [\\\"https://example.com/beruwala-beach-1.jpg\\\", \\\"https://example.com/beruwala-beach-2.jpg\\\"]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"day\\\": \\\"Oct 13 2024\\\",\\n      \\\"activities\\\": [\\n        {\\n          \\\"placeName\\\": \\\"Lunuganga Estate\\\",\\n          \\\"contact\\\": null,\\n          \\\"rating\\\": 4.2,\\n          \\\"geoCoords\\\": {\\n            \\\"lat\\\": 6.2504,\\n            \\\"lang\\\": 80.1841\\n          },\\n          \\\"description\\\": \\\"A beautiful botanical garden created by renowned architect Geoffrey Bawa, featuring a unique blend of tropical plants, sculptures, and architectural elements.\\\",\\n          \\\"whatToDo\\\": \\\"Explore the gardens, admire the sculptures, and enjoy the peaceful atmosphere. You can also visit the Bawa house, which is open to the public.\\\",\\n          \\\"ticketFees\\\": 10,\\n          \\\"openingHours\\\": \\\"9:00 AM - 5:00 PM\\\",\\n          \\\"imagesOfPlace\\\": [\\\"https://example.com/lunuganga-estate-1.jpg\\\", \\\"https://example.com/lunuganga-estate-2.jpg\\\"]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"day\\\": \\\"Oct 14 2024\\\",\\n      \\\"activities\\\": [\\n        {\\n          \\\"placeName\\\": \\\"The Old Galle Market\\\",\\n          \\\"contact\\\": null,\\n          \\\"rating\\\": 4.0,\\n          \\\"geoCoords\\\": {\\n            \\\"lat\\\": 6.0421,\\n            \\\"lang\\\": 80.2295\\n          },\\n          \\\"description\\\": \\\"A bustling market filled with fresh produce, spices, seafood, and local handicrafts. It's a great place to experience the local culture and find unique souvenirs.\\\",\\n          \\\"whatToDo\\\": \\\"Explore the market stalls, sample local delicacies, bargain for souvenirs, and immerse yourself in the vibrant atmosphere.\\\",\\n          \\\"ticketFees\\\": null,\\n          \\\"openingHours\\\": \\\"7:00 AM - 6:00 PM\\\",\\n          \\\"imagesOfPlace\\\": [\\\"https://example.com/galle-market-1.jpg\\\", \\\"https://example.com/galle-market-2.jpg\\\"]\\n        }\\n      ]\\n    }\\n  ],\\n  \\\"weather\\\": [\\n    {\\n      \\\"date\\\": \\\"Oct 11 2024\\\",\\n      \\\"conditions\\\": \\\"Sunny\\\",\\n      \\\"temperature\\\": 28,\\n      \\\"humidity\\\": 70,\\n      \\\"windSpeed\\\": 15\\n    },\\n    {\\n      \\\"date\\\": \\\"Oct 12 2024\\\",\\n      \\\"conditions\\\": \\\"Partly cloudy\\\",\\n      \\\"temperature\\\": 27,\\n      \\\"humidity\\\": 75,\\n      \\\"windSpeed\\\": 10\\n    },\\n    {\\n      \\\"date\\\": \\\"Oct 13 2024\\\",\\n      \\\"conditions\\\": \\\"Cloudy\\\",\\n      \\\"temperature\\\": 26,\\n      \\\"humidity\\\": 80,\\n      \\\"windSpeed\\\": 5\\n    },\\n    {\\n      \\\"date\\\": \\\"Oct 14 2024\\\",\\n      \\\"conditions\\\": \\\"Rainy\\\",\\n      \\\"temperature\\\": 25,\\n      \\\"humidity\\\": 85,\\n      \\\"windSpeed\\\": 10\\n    }\\n  ]\\n}\"\n}\n\n```"},
            ],
          },
          {
            role: "user",
            parts: [
              {text: "create a JSON file .  that has 3 separates  arrays of items and name of place that should be string  and description about the place   ,  first hotels  that must contain  : {name of the hotel, description, imgUrl, rating, fees,opening hours , geo coords:{lat,lang} , contact information, tickets  } , second item is activity , create a trip plan based on this information :  beruwala, sri lanka , solo trip,  duration of trip starts oct 11 2024 to oct 14 2024  , my interests in  hidden gems , beach  , luxury hotels ,street foods , cultural places   the activity array seems should be  :  trip_plan : [\n{\nday:\"oct 11 2024\",\nactivites : [{\nplace name , contact , rating , geo coords , description , what to do , ticket fees , opening hours , images of place ,\n}]\n}\n]  and finally create weather array , that has all weather information about the place and day  \n\nso all looks like :  {\nplace:\"\",\ndescription:\"\",\nhotels:[],\ntrip_plan:[],\nweather:[]\n\n\n"},
            ],
          },
          {
            role: "model",
            parts: [
              {text: "```json\n{\n  \"place\": \"Beruwala, Sri Lanka\",\n  \"description\": \"Beruwala is a coastal town in Sri Lanka known for its beautiful beaches, vibrant culture, and historical sites.\",\n  \"hotels\": [\n    {\n      \"name\": \"The Fortress Resort & Spa\",\n      \"description\": \"A luxurious beachfront resort with stunning ocean views, offering a range of amenities, including swimming pools, restaurants, and a spa.\",\n      \"imgUrl\": \"https://example.com/fortress-resort.jpg\",\n      \"rating\": 4.5,\n      \"fees\": {\n        \"standard_room\": 150,\n        \"suite\": 300\n      },\n      \"openingHours\": \"7:00 AM - 10:00 PM\",\n      \"geoCoords\": {\n        \"lat\": 6.3524,\n        \"lang\": 80.1446\n      },\n      \"contactInformation\": {\n        \"phone\": \"+94 11 234 5678\",\n        \"email\": \"info@fortressresort.com\"\n      },\n      \"tickets\": null\n    },\n    {\n      \"name\": \"The Beach House Beruwala\",\n      \"description\": \"A charming boutique hotel located directly on the beach, known for its intimate atmosphere and personalized service.\",\n      \"imgUrl\": \"https://example.com/beach-house.jpg\",\n      \"rating\": 4.0,\n      \"fees\": {\n        \"standard_room\": 100,\n        \"deluxe_room\": 150\n      },\n      \"openingHours\": \"8:00 AM - 9:00 PM\",\n      \"geoCoords\": {\n        \"lat\": 6.3492,\n        \"lang\": 80.1451\n      },\n      \"contactInformation\": {\n        \"phone\": \"+94 11 234 5679\",\n        \"email\": \"info@beachhouseberuwala.com\"\n      },\n      \"tickets\": null\n    },\n    {\n      \"name\": \"Palm Beach Hotel\",\n      \"description\": \"A family-friendly hotel offering a wide range of facilities, including a kids' club, swimming pool, and a variety of dining options.\",\n      \"imgUrl\": \"https://example.com/palm-beach-hotel.jpg\",\n      \"rating\": 3.5,\n      \"fees\": {\n        \"standard_room\": 75,\n        \"family_room\": 125\n      },\n      \"openingHours\": \"9:00 AM - 10:00 PM\",\n      \"geoCoords\": {\n        \"lat\": 6.3505,\n        \"lang\": 80.1463\n      },\n      \"contactInformation\": {\n        \"phone\": \"+94 11 234 5680\",\n        \"email\": \"info@palmbeachhotel.com\"\n      },\n      \"tickets\": null\n    }\n  ],\n  \"trip_plan\": [\n    {\n      \"day\": \"Oct 11 2024\",\n      \"activities\": [\n        {\n          \"placeName\": \"The Fortress Resort & Spa\",\n          \"contact\": \"+94 11 234 5678\",\n          \"rating\": 4.5,\n          \"geoCoords\": {\n            \"lat\": 6.3524,\n            \"lang\": 80.1446\n          },\n          \"description\": \"Check into the luxurious Fortress Resort & Spa, enjoying its stunning ocean views and amenities.\",\n          \"whatToDo\": \"Relax by the pool, explore the spa, or enjoy a delicious meal at one of the resort's restaurants.\",\n          \"ticketFees\": null,\n          \"openingHours\": \"7:00 AM - 10:00 PM\",\n          \"imagesOfPlace\": [\n            \"https://example.com/fortress-resort-1.jpg\",\n            \"https://example.com/fortress-resort-2.jpg\"\n          ]\n        },\n        {\n          \"placeName\": \"Beruwala Beach\",\n          \"contact\": null,\n          \"rating\": 4.5,\n          \"geoCoords\": {\n            \"lat\": 6.3504,\n            \"lang\": 80.1462\n          },\n          \"description\": \"Take a sunset stroll along Beruwala Beach, known for its golden sand and calm waters.\",\n          \"whatToDo\": \"Enjoy the serene ambiance, watch the sunset, or try some beachside street food.\",\n          \"ticketFees\": null,\n          \"openingHours\": \"24 hours\",\n          \"imagesOfPlace\": [\n            \"https://example.com/beruwala-beach-1.jpg\",\n            \"https://example.com/beruwala-beach-2.jpg\"\n          ]\n        }\n      ]\n    },\n    {\n      \"day\": \"Oct 12 2024\",\n      \"activities\": [\n        {\n          \"placeName\": \"Galle Fort\",\n          \"contact\": null,\n          \"rating\": 4.8,\n          \"geoCoords\": {\n            \"lat\": 6.0413,\n            \"lang\": 80.2301\n          },\n          \"description\": \"Explore the UNESCO World Heritage Site of Galle Fort, a well-preserved 17th-century Dutch fort with cobblestone streets, historic buildings, and stunning views of the Indian Ocean.\",\n          \"whatToDo\": \"Wander through the historic streets, visit the lighthouse, shop for souvenirs, and soak in the vibrant atmosphere.\",\n          \"ticketFees\": null,\n          \"openingHours\": \"8:00 AM - 6:00 PM\",\n          \"imagesOfPlace\": [\n            \"https://example.com/galle-fort-1.jpg\",\n            \"https://example.com/galle-fort-2.jpg\"\n          ]\n        },\n        {\n          \"placeName\": \"The Old Galle Market\",\n          \"contact\": null,\n          \"rating\": 4.0,\n          \"geoCoords\": {\n            \"lat\": 6.0421,\n            \"lang\": 80.2295\n          },\n          \"description\": \"Immerse yourself in the local culture at the bustling Old Galle Market, filled with fresh produce, spices, seafood, and local handicrafts.\",\n          \"whatToDo\": \"Sample local delicacies, bargain for souvenirs, and experience the vibrant atmosphere.\",\n          \"ticketFees\": null,\n          \"openingHours\": \"7:00 AM - 6:00 PM\",\n          \"imagesOfPlace\": [\n            \"https://example.com/galle-market-1.jpg\",\n            \"https://example.com/galle-market-2.jpg\"\n          ]\n        }\n      ]\n    },\n    {\n      \"day\": \"Oct 13 2024\",\n      \"activities\": [\n        {\n          \"placeName\": \"Lunuganga Estate\",\n          \"contact\": null,\n          \"rating\": 4.2,\n          \"geoCoords\": {\n            \"lat\": 6.2504,\n            \"lang\": 80.1841\n          },\n          \"description\": \"Discover the hidden gem of Lunuganga Estate, a beautiful botanical garden created by renowned architect Geoffrey Bawa, featuring a unique blend of tropical plants, sculptures, and architectural elements.\",\n          \"whatToDo\": \"Explore the gardens, admire the sculptures, and enjoy the peaceful atmosphere. You can also visit the Bawa house, which is open to the public.\",\n          \"ticketFees\": 10,\n          \"openingHours\": \"9:00 AM - 5:00 PM\",\n          \"imagesOfPlace\": [\n            \"https://example.com/lunuganga-estate-1.jpg\",\n            \"https://example.com/lunuganga-estate-2.jpg\"\n          ]\n        }\n      ]\n    },\n    {\n      \"day\": \"Oct 14 2024\",\n      \"activities\": [\n        {\n          \"placeName\": \"Beruwala Beach\",\n          \"contact\": null,\n          \"rating\": 4.5,\n          \"geoCoords\": {\n            \"lat\": 6.3504,\n            \"lang\": 80.1462\n          },\n          \"description\": \"Relax and enjoy a final day on Beruwala Beach, indulging in the tranquility and beauty of the coastline.\",\n          \"whatToDo\": \"Read a book, take a dip in the ocean, or simply soak up the sun and enjoy the stunning views.\",\n          \"ticketFees\": null,\n          \"openingHours\": \"24 hours\",\n          \"imagesOfPlace\": [\n            \"https://example.com/beruwala-beach-1.jpg\",\n            \"https://example.com/beruwala-beach-2.jpg\"\n          ]\n        }\n      ]\n    }\n  ],\n  \"weather\": [\n    {\n      \"date\": \"Oct 11 2024\",\n      \"conditions\": \"Sunny\",\n      \"temperature\": 28,\n      \"humidity\": 70,\n      \"windSpeed\": 15\n    },\n    {\n      \"date\": \"Oct 12 2024\",\n      \"conditions\": \"Partly cloudy\",\n      \"temperature\": 27,\n      \"humidity\": 75,\n      \"windSpeed\": 10\n    },\n    {\n      \"date\": \"Oct 13 2024\",\n      \"conditions\": \"Cloudy\",\n      \"temperature\": 26,\n      \"humidity\": 80,\n      \"windSpeed\": 5\n    },\n    {\n      \"date\": \"Oct 14 2024\",\n      \"conditions\": \"Rainy\",\n      \"temperature\": 25,\n      \"humidity\": 85,\n      \"windSpeed\": 10\n    }\n  ]\n}\n```\n\n**Explanation of the JSON structure:**\n\n* **place:** The name of the location (Beruwala, Sri Lanka).\n* **description:** A brief description of the location.\n* **hotels:** An array of hotels in Beruwala. Each hotel object has the following attributes:\n    * **name:** Name of the hotel.\n    * **description:** Description of the hotel.\n    * **imgUrl:** URL of the hotel's image.\n    * **rating:** Rating of the hotel (out of 5).\n    * **fees:** An object containing the fees for different room types.\n    * **openingHours:** Opening hours of the hotel.\n    * **geoCoords:** Coordinates of the hotel's location.\n    * **contactInformation:** Contact information for the hotel (phone and email).\n    * **tickets:** (Null in this example, you can include ticket information if applicable).\n* **trip_plan:** An array of days in the trip plan. Each day object has the following attributes:\n    * **day:** The date of the day.\n    * **activities:** An array of activities for that day. Each activity object has the following attributes:\n        * **placeName:** Name of the place.\n        * **contact:** Contact information for the place (if available).\n        * **rating:** Rating of the place (if available).\n        * **geoCoords:** Coordinates of the place's location.\n        * **description:** Description of the place.\n        * **whatToDo:** Suggested activities at the place.\n        * **ticketFees:** Ticket fees (if applicable).\n        * **openingHours:** Opening hours of the place.\n        * **imagesOfPlace:** URLs of images for the place.\n* **weather:** An array of weather information for each day of the trip. Each weather object has the following attributes:\n    * **date:** The date.\n    * **conditions:** Weather conditions (e.g., \"Sunny\", \"Partly cloudy\", \"Rainy\").\n    * **temperature:** Temperature in Celsius.\n    * **humidity:** Humidity percentage.\n    * **windSpeed:** Wind speed in kilometers per hour.\n\nThis JSON structure provides a comprehensive representation of the information for your solo trip to Beruwala, Sri Lanka. You can easily customize it by adding more hotels, activities, and weather information.\n"},
            ],
          },
        ],
      });
    
      const result = await chatSession.sendMessage(promt);
      console.log("result",result.response.text());

}


